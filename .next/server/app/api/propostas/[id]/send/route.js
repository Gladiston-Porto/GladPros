(()=>{var e={};e.id=7882,e.ids=[7882],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},26476:(e,t,r)=>{"use strict";r.d(t,{f6:()=>a,pQ:()=>s});var a=function(e){return e.RASCUNHO="RASCUNHO",e.ENVIADA="ENVIADA",e.ASSINADA="ASSINADA",e.APROVADA="APROVADA",e.CANCELADA="CANCELADA",e}({}),s=function(e){return e.CREATED="CREATED",e.UPDATED="UPDATED",e.SENT="SENT",e.SIGNED="SIGNED",e.APPROVED="APPROVED",e.CANCELLED="CANCELLED",e.ATTACH_ADDED="ATTACH_ADDED",e.ATTACH_REMOVED="ATTACH_REMOVED",e}({})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33911:(e,t,r)=>{"use strict";r.d(t,{db:()=>n});class a{constructor(e){this.proposta={},this.propostaLog={},this.propostaEtapa={},this.propostaMaterial={},this.cliente={},this.usuario={}}$connect(){return Promise.resolve()}$disconnect(){return Promise.resolve()}$transaction(e){return e({})}generatePropostaNumber(){let e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),s=Math.floor(1e3*Math.random()).toString().padStart(3,"0");return Promise.resolve(`PROP-${t}${r}${a}-${s}`)}}let s=globalThis;class o extends a{async generatePropostaNumber(){let e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),s=Math.floor(1e3*Math.random()).toString().padStart(3,"0");return`PROP-${t}${r}${a}-${s}`}}let n=s.prisma??new o},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},90956:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>A,serverHooks:()=>D,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>l});var a={};r.r(a),r.d(a,{POST:()=>d});var s=r(96559),o=r(48088),n=r(37719),i=r(32190),p=r(33911),u=r(26476);async function d(e,{params:t}){try{let{id:r}=t;if(!await p.db.proposta.findFirst({where:{id:r,deletedAt:null,status:u.f6.RASCUNHO}}))return i.NextResponse.json({error:"Proposta n\xe3o encontrada ou n\xe3o pode ser enviada"},{status:404});let a=await p.db.$transaction(async t=>{let a=await t.proposta.update({where:{id:r},data:{status:u.f6.ENVIADA,atualizadoEm:new Date}});return await t.propostaLog.create({data:{propostaId:r,usuarioId:"temp-user-id",acao:u.pQ.SENT,detalhes:`Proposta ${a.numeroProposta} enviada para o cliente`,ip:e.headers.get("x-forwarded-for")||"unknown",userAgent:e.headers.get("user-agent")||"unknown"}}),a});return i.NextResponse.json({message:"Proposta enviada com sucesso",proposta:a})}catch(e){return i.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let A=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/propostas/[id]/send/route",pathname:"/api/propostas/[id]/send",filename:"route",bundlePath:"app/api/propostas/[id]/send/route"},resolvedPagePath:"C:\\Users\\gladi\\Documents\\gladpros-nextjs\\src\\app\\api\\propostas\\[id]\\send\\route.ts",nextConfigOutput:"standalone",userland:a}),{workAsyncStorage:c,workUnitAsyncStorage:l,serverHooks:D}=A;function g(){return(0,n.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:l})}},96487:()=>{}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[7719,580],()=>r(90956));module.exports=a})();