(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5007],{29189:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var r=a(95155),t=a(66766),l=a(35695),n=a(12115),i=a(82764);function d(){let e=(0,l.useRouter)(),s=(0,l.useSearchParams)(),a=null==s?void 0:s.get("userId"),[d,o]=(0,n.useState)(0),[c,u]=(0,n.useState)(!1),[m,x]=(0,n.useState)(null),[h,g]=(0,n.useState)(""),[p,b]=(0,n.useState)(""),[f,j]=(0,n.useState)(""),[N,v]=(0,n.useState)(""),[y,w]=(0,n.useState)(""),[S,P]=(0,n.useState)(""),[C,D]=(0,n.useState)(null),k=[{id:"password",title:"Nova Senha",description:"Defina uma senha segura para sua conta",completed:!1},{id:"pin",title:"PIN de Seguran\xe7a",description:"Crie um PIN de 4 d\xedgitos para desbloqueio",completed:!1},{id:"security",title:"Pergunta de Seguran\xe7a",description:"Configure uma pergunta para recupera\xe7\xe3o de conta",completed:!1},{id:"confirm",title:"Confirma\xe7\xe3o",description:"Revise e finalize sua configura\xe7\xe3o",completed:!1}];(0,n.useEffect)(()=>{if(!a)return void e.push("/login")},[a,e]),(0,n.useEffect)(()=>{h?D(i.r.getPasswordStrength(h)):D(null)},[h]);let M=async()=>{d<k.length-1?o(d+1):await E()},E=async()=>{u(!0),x(null);try{let s=await fetch("/api/auth/first-access/setup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:parseInt(a),newPassword:h,pin:f,securityQuestion:y,securityAnswer:S.toLowerCase().trim()})}),r=await s.json();if(!s.ok)throw Error(r.error||"Erro ao configurar conta");e.push("/dashboard?setup=complete")}catch(e){console.error("Erro na configura\xe7\xe3o:",e),x(e.message)}finally{u(!1)}};return a?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(t.default,{src:"/images/LOGO_300.png",alt:"GladPros",width:60,height:60,className:"rounded-lg"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Bem-vindo ao GladPros!"}),(0,r.jsx)("p",{className:"text-blue-100",children:"Configure sua conta para come\xe7ar"})]})]})}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)("div",{className:"w-1/3 bg-gray-50 p-6",children:[(0,r.jsx)("h2",{className:"font-semibold text-gray-800 mb-4",children:"Passos da Configura\xe7\xe3o"}),(0,r.jsx)("div",{className:"space-y-4",children:k.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-3 rounded-lg ".concat(s===d?"bg-blue-100 border-2 border-blue-300":s<d?"bg-green-100 border-2 border-green-300":"bg-white border-2 border-gray-200"),children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold ".concat(s===d?"bg-blue-500 text-white":s<d?"bg-green-500 text-white":"bg-gray-300 text-gray-600"),children:s<d?"✓":s+1}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-sm",children:e.title}),(0,r.jsx)("p",{className:"text-xs text-gray-600",children:e.description})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"w-2/3 p-8",children:[m&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,r.jsx)("p",{className:"text-red-700 text-sm",children:m})}),0===d&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Defina sua Nova Senha"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Crie uma senha forte que ser\xe1 usada para acessar sua conta."}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nova Senha"}),(0,r.jsx)("input",{type:"password",value:h,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite sua nova senha"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar Senha"}),(0,r.jsx)("input",{type:"password",value:p,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite novamente sua senha"})]}),C&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"For\xe7a da Senha"}),(0,r.jsx)("span",{className:"text-sm font-semibold",style:{color:C.color},children:C.label})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-3",children:(0,r.jsx)("div",{className:"h-2 rounded-full transition-all duration-300",style:{width:"".concat(C.score,"%"),backgroundColor:C.color}})}),(0,r.jsx)("div",{className:"space-y-1",children:C.criteriaMet.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-green-500 text-xs",children:"✓"}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:e})]},s))})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-semibold text-blue-800 text-sm mb-2",children:"Requisitos da Senha:"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,r.jsx)("li",{children:"• M\xednimo 9 caracteres"}),(0,r.jsx)("li",{children:"• Pelo menos 1 letra mai\xfascula"}),(0,r.jsx)("li",{children:"• Pelo menos 1 n\xfamero"}),(0,r.jsx)("li",{children:"• Pelo menos 1 s\xedmbolo (!@#$%&*)"})]})]})]})]}),1===d&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"PIN de Seguran\xe7a"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Crie um PIN de 4 d\xedgitos que ser\xe1 usado para desbloquear sua conta em casos de bloqueio."}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PIN (4 d\xedgitos)"}),(0,r.jsx)("input",{type:"password",value:f,onChange:e=>{j(e.target.value.replace(/\D/g,"").slice(0,4))},className:"w-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-center text-lg tracking-widest",placeholder:"****",maxLength:4})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar PIN"}),(0,r.jsx)("input",{type:"password",value:N,onChange:e=>{v(e.target.value.replace(/\D/g,"").slice(0,4))},className:"w-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-center text-lg tracking-widest",placeholder:"****",maxLength:4})]}),f&&N&&f!==N&&(0,r.jsx)("p",{className:"text-red-600 text-sm",children:"Os PINs n\xe3o coincidem"}),(0,r.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-semibold text-yellow-800 text-sm mb-2",children:"\uD83D\uDD12 Sobre o PIN:"}),(0,r.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,r.jsx)("li",{children:"• Use apenas n\xfameros (0-9)"}),(0,r.jsx)("li",{children:"• Evite sequ\xeancias \xf3bvias (1234, 0000)"}),(0,r.jsx)("li",{children:"• Ser\xe1 necess\xe1rio para desbloquear a conta"}),(0,r.jsx)("li",{children:"• Mantenha-o seguro e n\xe3o compartilhe"})]})]})]})]}),2===d&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Pergunta de Seguran\xe7a"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Escolha uma pergunta de seguran\xe7a que ser\xe1 usada para recuperar sua conta."}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pergunta de Seguran\xe7a"}),(0,r.jsxs)("select",{value:y,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Selecione uma pergunta..."}),["Qual \xe9 o nome do seu primeiro animal de estima\xe7\xe3o?","Em que cidade voc\xea nasceu?","Qual \xe9 o nome de solteira da sua m\xe3e?","Qual foi sua primeira escola?","Qual \xe9 seu filme favorito?","Qual \xe9 o nome da sua rua favorita?","Qual foi seu primeiro emprego?","Qual \xe9 sua comida favorita?"].map((e,s)=>(0,r.jsx)("option",{value:e,children:e},s))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Resposta"}),(0,r.jsx)("input",{type:"text",value:S,onChange:e=>P(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite sua resposta"})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-semibold text-green-800 text-sm mb-2",children:"\uD83D\uDCA1 Dicas:"}),(0,r.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:[(0,r.jsx)("li",{children:"• Escolha algo que voc\xea nunca esquecer\xe1"}),(0,r.jsx)("li",{children:"• Seja espec\xedfico na resposta"}),(0,r.jsx)("li",{children:"• Use apenas letras min\xfasculas"}),(0,r.jsx)("li",{children:"• Evite acentos e caracteres especiais"})]})]})]})]}),3===d&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Configura\xe7\xe3o Completa"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Revise suas configura\xe7\xf5es antes de finalizar."}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold text-green-800 mb-3",children:"✓ Configura\xe7\xf5es Definidas:"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-green-700",children:"Nova senha:"}),(0,r.jsx)("span",{className:"text-green-800 font-medium",children:"••••••••••"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-green-700",children:"PIN de seguran\xe7a:"}),(0,r.jsx)("span",{className:"text-green-800 font-medium",children:"••••"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-green-700",children:"Pergunta de seguran\xe7a:"}),(0,r.jsx)("span",{className:"text-green-800 font-medium",children:"Configurada"})]})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-semibold text-blue-800 text-sm mb-2",children:"\uD83C\uDF89 Pr\xf3ximos Passos:"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,r.jsx)("li",{children:"• Sua senha provis\xf3ria ser\xe1 substitu\xedda"}),(0,r.jsx)("li",{children:"• Voc\xea ser\xe1 redirecionado para o dashboard"}),(0,r.jsx)("li",{children:"• Poder\xe1 acessar todas as funcionalidades do sistema"}),(0,r.jsx)("li",{children:"• Suas configura\xe7\xf5es de seguran\xe7a estar\xe3o ativas"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[(0,r.jsx)("button",{onClick:()=>d>0&&o(d-1),disabled:0===d||c,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),(0,r.jsxs)("button",{onClick:M,disabled:c||0===d&&!(h&&p&&h===p&&i.r.validatePassword(h).valid)||1===d&&!(4===f.length&&4===N.length&&f===N&&/^\d{4}$/.test(f))||2===d&&!(y&&S.length>=3),className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[c&&(0,r.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2"}),d===k.length-1?"Finalizar Configura\xe7\xe3o":"Pr\xf3ximo"]})]})]})]})]})}):(0,r.jsx)("div",{children:"Redirecionando..."})}function o(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{children:"Carregando..."}),children:(0,r.jsx)(d,{})})}},38423:(e,s,a)=>{Promise.resolve().then(a.bind(a,29189))},82764:(e,s,a)=>{"use strict";a.d(s,{r:()=>t});var r=a(6238);class t{static validatePassword(e){let s=[];return(!e||e.length<9)&&s.push("Senha deve ter no m\xednimo 9 caracteres"),/[A-Z]/.test(e)||s.push("Senha deve conter pelo menos 1 letra mai\xfascula"),/[0-9]/.test(e)||s.push("Senha deve conter pelo menos 1 n\xfamero"),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)||s.push("Senha deve conter pelo menos 1 s\xedmbolo especial"),{valid:0===s.length,errors:s}}static async hashPassword(e){return r.Ay.hash(e,12)}static async verifyPassword(e,s){return r.Ay.compare(e,s)}static generateProvisionalPassword(){let e="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789",s="!@#$%&*",a="";a+="ABCDEFGHJKLMNPQRSTUVWXYZ"[Math.floor(25*Math.random())],a+="23456789"[Math.floor(8*Math.random())],a+=s[Math.floor(Math.random()*s.length)];for(let s=0;s<6;s++)a+=e[Math.floor(Math.random()*e.length)];return a.split("").sort(()=>Math.random()-.5).join("")}static getPasswordStrength(e){let s=0,a=[];e.length>=9&&(s+=20,a.push("M\xednimo 9 caracteres")),/[A-Z]/.test(e)&&(s+=20,a.push("Letra mai\xfascula")),/[a-z]/.test(e)&&(s+=10,a.push("Letra min\xfascula")),/[0-9]/.test(e)&&(s+=20,a.push("N\xfamero")),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)&&(s+=20,a.push("S\xedmbolo especial")),e.length>=12&&(s+=10,a.push("Senha longa (12+ caracteres)"));let r="Muito fraca",t="#ef4444";return s>=90?(r="Muito forte",t="#22c55e"):s>=70?(r="Forte",t="#84cc16"):s>=50?(r="Moderada",t="#eab308"):s>=30&&(r="Fraca",t="#f97316"),{score:s,label:r,color:t,criteriaMet:a}}}},89180:()=>{}},e=>{var s=s=>e(e.s=s);e.O(0,[6766,4552,8441,1684,7358],()=>s(38423)),_N_E=e.O()}]);