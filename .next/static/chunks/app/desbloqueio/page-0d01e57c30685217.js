(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2597],{4905:(e,t,s)=>{Promise.resolve().then(s.bind(s,81907))},35695:(e,t,s)=>{"use strict";var r=s(18999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},50737:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(95155);function a(e){let{label:t,name:s,value:a,onChange:n,placeholder:i,type:o="text",required:l=!1,error:d,className:c=""}=e;return(0,r.jsxs)("div",{className:"mb-4 ".concat(c),children:[t&&(0,r.jsx)("label",{htmlFor:s,className:"mb-2 block text-sm font-medium text-gray-700",children:t}),(0,r.jsx)("input",{id:s,name:s,type:o,value:a,onChange:e=>n(e.target.value),placeholder:i,required:l,className:"w-full h-11 rounded-xl border px-4 py-3 text-sm transition-colors focus:border-[#0098DA] focus:outline-none focus:ring-2 focus:ring-[#0098DA]/20 ".concat(d?"border-red-300 bg-red-50":"border-gray-300 bg-white hover:border-gray-400")}),d&&(0,r.jsx)("p",{className:"mt-1 text-xs text-red-600",children:d})]})}s(12115)},81907:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x,dynamic:()=>c,runtime:()=>u});var r=s(95155),a=s(66766),n=s(6874),i=s.n(n),o=s(35695),l=s(12115),d=s(50737);let c="force-dynamic",u="nodejs";function m(){let e=(0,o.useRouter)(),t=(0,o.useSearchParams)(),s=(null==t?void 0:t.get("email"))||"",[n,c]=(0,l.useState)("identify"),[u,m]=(0,l.useState)(s),[x,h]=(0,l.useState)(""),[b,f]=(0,l.useState)(""),[p,g]=(0,l.useState)(null),[y,j]=(0,l.useState)(!1),[N,v]=(0,l.useState)(null),[w,S]=(0,l.useState)(!1),D=(0,l.useCallback)(async()=>{if(u.trim()){j(!0),v(null);try{let e=await fetch("/api/auth/user-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u.trim()})}),t=await e.json();if(!e.ok)throw Error(t.error||"Erro ao verificar usu\xe1rio");if(!t.blocked)return void v("Esta conta n\xe3o est\xe1 bloqueada.");g(t.user),t.user.requiresPinUnlock?c("pin"):t.user.requiresSecurityQuestion?c("security"):v("Esta conta n\xe3o possui m\xe9todos de desbloqueio configurados. Entre em contato com o administrador.")}catch(e){v(e instanceof Error?e.message:"Erro inesperado")}finally{j(!1)}}},[u]);async function k(){if(p&&x.trim()){j(!0),v(null);try{let t=await fetch("/api/auth/unlock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({method:"pin",userId:p.id,pin:x.trim()})}),s=await t.json();if(!t.ok)throw Error(s.error||"PIN inv\xe1lido");S(!0),setTimeout(()=>{e.push("/login")},2e3)}catch(e){v(e instanceof Error?e.message:"Erro ao desbloquear conta")}finally{j(!1)}}}async function C(){if(p&&b.trim()){j(!0),v(null);try{let t=await fetch("/api/auth/unlock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({method:"security",userId:p.id,answer:b.trim()})}),s=await t.json();if(!t.ok)throw Error(s.error||"Resposta inv\xe1lida");S(!0),setTimeout(()=>{e.push("/login")},2e3)}catch(e){v(e instanceof Error?e.message:"Erro ao desbloquear conta")}finally{j(!1)}}}return((0,l.useEffect)(()=>{s&&"identify"===n&&D()},[s,n,D]),w)?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-black/10 shadow-xl p-8 text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Conta Desbloqueada!"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Sua conta foi desbloqueada com sucesso. Voc\xea ser\xe1 redirecionado para a p\xe1gina de login."}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Redirecionando em 2 segundos..."})]})})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-black/10 shadow-xl p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)(a.default,{src:"/images/LOGO_300.png",alt:"GladPros",width:80,height:80,className:"mx-auto mb-4 rounded-xl",style:{height:"auto"}}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Desbloquear Conta"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm mt-1",children:["identify"===n&&"Informe seu email para verificar op\xe7\xf5es de desbloqueio","pin"===n&&"Digite seu PIN de 4 d\xedgitos para desbloquear","security"===n&&"Responda sua pergunta de seguran\xe7a"]})]}),N&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl",children:(0,r.jsx)("p",{className:"text-red-700 text-sm",children:N})}),"identify"===n&&(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),D()},className:"space-y-6",children:[(0,r.jsx)(d.A,{label:"E-mail da conta bloqueada",name:"email",type:"email",value:u,onChange:m,placeholder:"seu@exemplo.com",required:!0}),(0,r.jsxs)("button",{type:"submit",disabled:y||!/.+@.+\..+/.test(u),className:"w-full h-11 bg-[#0098DA] text-white font-medium rounded-xl hover:brightness-110 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center",children:[y&&(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),y?"Verificando...":"Verificar Conta"]})]}),"pin"===n&&p&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-200",children:[(0,r.jsx)("h3",{className:"font-medium text-blue-800 mb-1",children:"Conta Identificada"}),(0,r.jsx)("p",{className:"text-blue-700 text-sm",children:p.nomeCompleto}),(0,r.jsx)("p",{className:"text-blue-600 text-xs",children:p.email})]}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),k()},className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"PIN de Seguran\xe7a (4 d\xedgitos)"}),(0,r.jsx)("input",{type:"password",value:x,onChange:e=>{h(e.target.value.replace(/\D/g,"").slice(0,4))},placeholder:"****",maxLength:4,className:"w-32 h-11 rounded-xl border border-gray-300 px-4 py-3 text-center text-lg tracking-widest focus:border-[#0098DA] focus:outline-none focus:ring-2 focus:ring-[#0098DA]/20 transition-colors"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>c("identify"),className:"flex-1 h-11 border border-gray-300 text-gray-700 font-medium rounded-xl hover:bg-gray-50 transition-colors",children:"Voltar"}),(0,r.jsxs)("button",{type:"submit",disabled:y||4!==x.length,className:"flex-1 h-11 bg-[#0098DA] text-white font-medium rounded-xl hover:brightness-110 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center",children:[y&&(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),y?"Desbloqueando...":"Desbloquear"]})]}),p.requiresSecurityQuestion&&(0,r.jsx)("div",{className:"text-center pt-4 border-t",children:(0,r.jsx)("button",{type:"button",onClick:()=>c("security"),className:"text-[#0098DA] hover:text-[#0098DA]/80 text-sm font-medium transition-colors",children:"Usar pergunta de seguran\xe7a"})})]})]}),"security"===n&&p&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-200",children:[(0,r.jsx)("h3",{className:"font-medium text-blue-800 mb-1",children:"Conta Identificada"}),(0,r.jsx)("p",{className:"text-blue-700 text-sm",children:p.nomeCompleto}),(0,r.jsx)("p",{className:"text-blue-600 text-xs",children:p.email})]}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),C()},className:"space-y-6",children:[p.perguntaSecreta&&(0,r.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-xl border border-yellow-200",children:[(0,r.jsx)("h3",{className:"font-medium text-yellow-800 mb-1",children:"Pergunta de Seguran\xe7a"}),(0,r.jsx)("p",{className:"text-yellow-700 text-sm",children:p.perguntaSecreta})]}),(0,r.jsx)(d.A,{label:"Resposta de Seguran\xe7a",name:"security-answer",value:b,onChange:f,placeholder:"Digite sua resposta",required:!0}),(0,r.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,r.jsxs)("p",{className:"text-gray-600 text-xs",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"Dica:"})," Digite a resposta exatamente como cadastrou, sem acentos e em letras min\xfasculas."]})}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>c("identify"),className:"flex-1 h-11 border border-gray-300 text-gray-700 font-medium rounded-xl hover:bg-gray-50 transition-colors",children:"Voltar"}),(0,r.jsxs)("button",{type:"submit",disabled:y||!b.trim(),className:"flex-1 h-11 bg-[#0098DA] text-white font-medium rounded-xl hover:brightness-110 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center",children:[y&&(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),y?"Desbloqueando...":"Desbloquear"]})]}),p.requiresPinUnlock&&(0,r.jsx)("div",{className:"text-center pt-4 border-t",children:(0,r.jsx)("button",{type:"button",onClick:()=>c("pin"),className:"text-[#0098DA] hover:text-[#0098DA]/80 text-sm font-medium transition-colors",children:"Usar PIN de seguran\xe7a"})})]})]}),(0,r.jsxs)("div",{className:"mt-8 pt-6 border-t space-y-3",children:[(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(i(),{href:"/login",className:"text-gray-600 hover:text-gray-800 text-sm transition-colors",children:"Voltar para Login"})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(i(),{href:"/esqueci-senha",className:"text-[#0098DA] hover:text-[#0098DA]/80 text-sm font-medium transition-colors",children:"Esqueceu sua senha?"})})]})]}),(0,r.jsx)("div",{className:"text-center mt-6",children:(0,r.jsx)("p",{className:"text-gray-500 text-xs",children:"\xa9 2025 GladPros. Sistema de gest\xe3o empresarial."})})]})})}function x(){return(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)("div",{children:"Carregando..."}),children:(0,r.jsx)(m,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6766,6874,8441,1684,7358],()=>t(4905)),_N_E=e.O()}]);