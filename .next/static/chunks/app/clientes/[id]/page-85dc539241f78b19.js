(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3086],{11764:(e,t,i)=>{"use strict";i.d(t,{default:()=>c});var s=i(95155),l=i(12115),a=i(35695),n=i(35050),r=i(53171),o=i(16447);function c(e){let{params:t}=e,i=(null==t?void 0:t.id)||"",c=(0,a.useRouter)(),{showToast:d}=(0,o.d)(),[u,h]=(0,l.useState)(null),[m,f]=(0,l.useState)(!0),[v,p]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await fetch("/api/clientes/".concat(i));if(!t.ok)throw Error("Cliente n\xe3o encontrado");let s=await t.json();e||h(s)}catch(t){if(e)return;console.error("Erro ao carregar cliente:",t),d({title:"Erro",message:t.message||"Erro ao carregar cliente",type:"error"}),c.push("/clientes")}finally{e||f(!1)}})(),()=>{e=!0}},[i,c,d]);let g=async e=>{p(!0);try{let t=await fetch("/api/clientes/".concat(i),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let i=await t.json();if(null==i?void 0:i.details)throw{message:String(i.error||i.message||"Dados inv\xe1lidos"),details:i.details};let s=(null==i?void 0:i.error)||(null==i?void 0:i.message)||"",l={};if(/e-mail.*cadastrado|E-mail.*cadastrado/i.test(s)&&(l.email=s),/Documento.*cadastrado/i.test(s)&&((null==e?void 0:e.tipo)==="PJ"&&(null==e?void 0:e.ein)&&(l.ein=s),(null==e?void 0:e.tipo)==="PF"&&((null==e?void 0:e.tipoDocumentoPF)==="SSN"&&(null==e?void 0:e.ssn)&&(l.ssn=s),(null==e?void 0:e.tipoDocumentoPF)==="ITIN"&&(null==e?void 0:e.itin)&&(l.itin=s))),Object.keys(l).length)throw{message:s||"Dados inv\xe1lidos",fieldErrors:l};throw Error(s||"Erro ao atualizar cliente")}d({title:"Sucesso",message:"Cliente atualizado com sucesso",type:"success"}),c.push("/clientes")}catch(e){if(null==e?void 0:e.details)throw e;d({title:"Erro",message:e.message||"Erro ao atualizar cliente",type:"error"})}finally{p(!1)}};return m?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("h2",{className:"font-title text-xl",children:"Editar Cliente"})}),(0,s.jsx)(r.Panel,{title:"Carregando...",children:(0,s.jsx)("div",{className:"p-6 text-center text-gray-500",children:"Carregando dados do cliente..."})})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("h2",{className:"font-title text-xl",children:"Editar Cliente"})}),(0,s.jsx)(r.Panel,{title:"Editar Cliente",children:(0,s.jsx)(n.D,{cliente:u,onSubmit:g,onCancel:()=>c.push("/clientes"),loading:v})})]})}},45964:(e,t,i)=>{Promise.resolve().then(i.bind(i,11764))}},e=>{var t=t=>e(e.s=t);e.O(0,[6766,6874,2186,3171,5568,8441,1684,7358],()=>t(45964)),_N_E=e.O()}]);